# HTTP 缓存机制 - NodeJS一步一步试验
## Web 缓存是什么
### 动机
当浏览器加载一个页面时html引用的外部资源也会加载。但是这些外部资源比如图片、CSS、JS都不经常变化。如果每次都加载这资源势必会带来资源的浪费。而且加载时间过长也会影响用户体验。

HTTP缓存技术就是为了解决这个问题出现的。简单的讲HTTP缓存就是将静态资源存储在浏览器内部，下次请求相同资源时可以直接使用。

当然何时使用何时不使用要有一系列的策略保证如果资源一旦更新，缓存也要随着更新。
### 强缓存策略
直接从本地副本比对读取，不去请求服务器，返回的状态码为200

这里面就有一个问题如果不去服务请求如果静态资源更新了而浏览器还在使用旧的静态资源怎么办？答案是使用定时器的方式也就是强缓存可以设置静态资源的有效期。如果超过有效期就认为缓存作废。

### 协商缓存策略
上面的expires 和 cache-control 都会访问本地缓存直接验证看是否过期，如果没过期直接使用本地缓存，并返回200.但如果设置了no-cache 和 no-store 则本地缓存会被忽略，回去请求服务器验证资源是否更新，如果没更新继续使用本地缓存，此时返回304，这就是协商缓存。协商缓存主要包括 last-modified 和 etag

协商缓存简单的说就是浏览器和服务器间就是否要使用缓存做协商。如果协商的结果是需要更新就会返回200并返回更新内容。如果不需要更新只需要返回状态码304，这样虽然需要后端应答但是后端既不需要生成内容也不需要传输内容。依然可以享受缓存的种种好处

#### last-Modified & if-Modified-Sinced

#### etag & if-None-Match